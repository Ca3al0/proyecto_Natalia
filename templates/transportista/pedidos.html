<table>
  <tr>
    <th>Pedido</th>
    <th>Estado</th>
    <th>Acci√≥n</th>
  </tr>
  {% for pedido in pedidos %}
  <tr>
    <td>{{ pedido.ID_Pedido }}</td>
    <td id="estado-{{ pedido.ID_Pedido }}">{{ pedido.Estado }}</td>
    <td>
      <select onchange="cambiarEstadoPedido({{ pedido.ID_Pedido }}, this.value)">
        <option value="pendiente" {% if pedido.Estado=='pendiente' %}selected{% endif %}>Pendiente</option>
        <option value="en proceso" {% if pedido.Estado=='en proceso' %}selected{% endif %}>En proceso</option>
        <option value="en reparto" {% if pedido.Estado=='en reparto' %}selected{% endif %}>En reparto</option>
        <option value="entregado" {% if pedido.Estado=='entregado' %}selected{% endif %}>Entregado</option>
      </select>
    </td>
  </tr>
  {% endfor %}
</table>

<script>
function cambiarEstadoPedido(pedidoId, estado) {
    fetch(`/cliente/pedido/${pedidoId}/estado`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({estado: estado})
    })
    .then(res => res.json())
    .then(data => {
        alert(data.message);
        // Actualizar el texto del estado en la tabla
        document.getElementById(`estado-${pedidoId}`).textContent = estado;
    });
}
</script>
